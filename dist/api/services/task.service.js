"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _task = _interopRequireDefault(require("../models/task"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/* eslint-disable prettier/prettier */
const taskObject = req => {
  return new _task.default({ ...req.body
  });
};

const getAllTasks = creator => {
  return _task.default.find({
    creator
  }).populate([{
    path: 'assignee',
    select: 'firstName lastName'
  }, {
    path: 'site',
    select: 'name'
  }]);
};

const saveTask = task => {
  return task.save().then(t => t.populate([{
    path: 'assignee',
    select: 'firstName lastName'
  }, {
    path: 'site',
    select: 'name'
  }]).execPopulate());
};

const getTask = _id => {
  return _task.default.findOne({
    _id
  }).populate([{
    path: 'assignee',
    select: 'firstName lastName'
  }, {
    path: 'site',
    select: 'name'
  }]);
};

const updateTask = (id, task) => {
  return _task.default.updateOne({
    _id: id
  }, {
    $set: task
  });
};

const deleteTask = _id => {
  return _task.default.findOneAndDelete({
    _id
  });
};

const userService = {
  saveTask,
  getTask,
  updateTask,
  taskObject,
  getAllTasks,
  deleteTask
};
var _default = userService;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NlcnZlci9hcGkvc2VydmljZXMvdGFzay5zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbInRhc2tPYmplY3QiLCJyZXEiLCJUYXNrIiwiYm9keSIsImdldEFsbFRhc2tzIiwiY3JlYXRvciIsImZpbmQiLCJwb3B1bGF0ZSIsInBhdGgiLCJzZWxlY3QiLCJzYXZlVGFzayIsInRhc2siLCJzYXZlIiwidGhlbiIsInQiLCJleGVjUG9wdWxhdGUiLCJnZXRUYXNrIiwiX2lkIiwiZmluZE9uZSIsInVwZGF0ZVRhc2siLCJpZCIsInVwZGF0ZU9uZSIsIiRzZXQiLCJkZWxldGVUYXNrIiwiZmluZE9uZUFuZERlbGV0ZSIsInVzZXJTZXJ2aWNlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQ0E7Ozs7QUFEQTtBQUdBLE1BQU1BLFVBQVUsR0FBSUMsR0FBRCxJQUFTO0FBQ3hCLFNBQU8sSUFBSUMsYUFBSixDQUFTLEVBQ1osR0FBR0QsR0FBRyxDQUFDRTtBQURLLEdBQVQsQ0FBUDtBQUdILENBSkQ7O0FBS0EsTUFBTUMsV0FBVyxHQUFJQyxPQUFELElBQWE7QUFDN0IsU0FBT0gsY0FBS0ksSUFBTCxDQUFVO0FBQUVELElBQUFBO0FBQUYsR0FBVixFQUF1QkUsUUFBdkIsQ0FBZ0MsQ0FBQztBQUFFQyxJQUFBQSxJQUFJLEVBQUMsVUFBUDtBQUFtQkMsSUFBQUEsTUFBTSxFQUFFO0FBQTNCLEdBQUQsRUFBbUQ7QUFBRUQsSUFBQUEsSUFBSSxFQUFFLE1BQVI7QUFBZ0JDLElBQUFBLE1BQU0sRUFBRTtBQUF4QixHQUFuRCxDQUFoQyxDQUFQO0FBQ0gsQ0FGRDs7QUFHQSxNQUFNQyxRQUFRLEdBQUlDLElBQUQsSUFBVTtBQUN2QixTQUFPQSxJQUFJLENBQUNDLElBQUwsR0FBWUMsSUFBWixDQUFpQkMsQ0FBQyxJQUFJQSxDQUFDLENBQUNQLFFBQUYsQ0FBVyxDQUFDO0FBQUVDLElBQUFBLElBQUksRUFBQyxVQUFQO0FBQW1CQyxJQUFBQSxNQUFNLEVBQUU7QUFBM0IsR0FBRCxFQUFtRDtBQUFFRCxJQUFBQSxJQUFJLEVBQUUsTUFBUjtBQUFnQkMsSUFBQUEsTUFBTSxFQUFFO0FBQXhCLEdBQW5ELENBQVgsRUFBZ0dNLFlBQWhHLEVBQXRCLENBQVA7QUFDSCxDQUZEOztBQUlBLE1BQU1DLE9BQU8sR0FBSUMsR0FBRCxJQUFTO0FBQ3JCLFNBQU9mLGNBQUtnQixPQUFMLENBQWE7QUFBRUQsSUFBQUE7QUFBRixHQUFiLEVBQXNCVixRQUF0QixDQUErQixDQUFDO0FBQUVDLElBQUFBLElBQUksRUFBQyxVQUFQO0FBQW1CQyxJQUFBQSxNQUFNLEVBQUU7QUFBM0IsR0FBRCxFQUFtRDtBQUFFRCxJQUFBQSxJQUFJLEVBQUUsTUFBUjtBQUFnQkMsSUFBQUEsTUFBTSxFQUFFO0FBQXhCLEdBQW5ELENBQS9CLENBQVA7QUFDSCxDQUZEOztBQUlBLE1BQU1VLFVBQVUsR0FBRyxDQUFDQyxFQUFELEVBQUtULElBQUwsS0FBYztBQUM3QixTQUFPVCxjQUFLbUIsU0FBTCxDQUNIO0FBQUVKLElBQUFBLEdBQUcsRUFBRUc7QUFBUCxHQURHLEVBRUg7QUFDSUUsSUFBQUEsSUFBSSxFQUFFWDtBQURWLEdBRkcsQ0FBUDtBQU1ILENBUEQ7O0FBUUEsTUFBTVksVUFBVSxHQUFJTixHQUFELElBQVM7QUFDeEIsU0FBT2YsY0FBS3NCLGdCQUFMLENBQXNCO0FBQUVQLElBQUFBO0FBQUYsR0FBdEIsQ0FBUDtBQUNILENBRkQ7O0FBR0EsTUFBTVEsV0FBVyxHQUFHO0FBQ2hCZixFQUFBQSxRQURnQjtBQUVoQk0sRUFBQUEsT0FGZ0I7QUFHaEJHLEVBQUFBLFVBSGdCO0FBSWhCbkIsRUFBQUEsVUFKZ0I7QUFLaEJJLEVBQUFBLFdBTGdCO0FBTWhCbUIsRUFBQUE7QUFOZ0IsQ0FBcEI7ZUFRZUUsVyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIHByZXR0aWVyL3ByZXR0aWVyICovXG5pbXBvcnQgVGFzayBmcm9tIFwiLi4vbW9kZWxzL3Rhc2tcIjtcblxuY29uc3QgdGFza09iamVjdCA9IChyZXEpID0+IHtcbiAgICByZXR1cm4gbmV3IFRhc2soe1xuICAgICAgICAuLi5yZXEuYm9keVxuICAgIH0pO1xufVxuY29uc3QgZ2V0QWxsVGFza3MgPSAoY3JlYXRvcikgPT4ge1xuICAgIHJldHVybiBUYXNrLmZpbmQoeyBjcmVhdG9yIH0pLnBvcHVsYXRlKFt7IHBhdGg6J2Fzc2lnbmVlJywgc2VsZWN0OiAnZmlyc3ROYW1lIGxhc3ROYW1lJ30sIHsgcGF0aDogJ3NpdGUnLCBzZWxlY3Q6ICduYW1lJ31dKTtcbn1cbmNvbnN0IHNhdmVUYXNrID0gKHRhc2spID0+IHtcbiAgICByZXR1cm4gdGFzay5zYXZlKCkudGhlbih0ID0+IHQucG9wdWxhdGUoW3sgcGF0aDonYXNzaWduZWUnLCBzZWxlY3Q6ICdmaXJzdE5hbWUgbGFzdE5hbWUnfSwgeyBwYXRoOiAnc2l0ZScsIHNlbGVjdDogJ25hbWUnfV0pLmV4ZWNQb3B1bGF0ZSgpKTtcbn1cblxuY29uc3QgZ2V0VGFzayA9IChfaWQpID0+IHtcbiAgICByZXR1cm4gVGFzay5maW5kT25lKHsgX2lkIH0pLnBvcHVsYXRlKFt7IHBhdGg6J2Fzc2lnbmVlJywgc2VsZWN0OiAnZmlyc3ROYW1lIGxhc3ROYW1lJ30sIHsgcGF0aDogJ3NpdGUnLCBzZWxlY3Q6ICduYW1lJ31dKTtcbn1cblxuY29uc3QgdXBkYXRlVGFzayA9IChpZCwgdGFzaykgPT4ge1xuICAgIHJldHVybiBUYXNrLnVwZGF0ZU9uZShcbiAgICAgICAgeyBfaWQ6IGlkIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgICRzZXQ6IHRhc2tcbiAgICAgICAgfVxuICAgICk7XG59XG5jb25zdCBkZWxldGVUYXNrID0gKF9pZCkgPT4ge1xuICAgIHJldHVybiBUYXNrLmZpbmRPbmVBbmREZWxldGUoeyBfaWQgfSk7XG59XG5jb25zdCB1c2VyU2VydmljZSA9IHtcbiAgICBzYXZlVGFzayxcbiAgICBnZXRUYXNrLFxuICAgIHVwZGF0ZVRhc2ssXG4gICAgdGFza09iamVjdCxcbiAgICBnZXRBbGxUYXNrcyxcbiAgICBkZWxldGVUYXNrXG59XG5leHBvcnQgZGVmYXVsdCB1c2VyU2VydmljZTsiXX0=